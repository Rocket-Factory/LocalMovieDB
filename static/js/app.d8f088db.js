(function(t){function e(e){for(var n,l,s=e[0],r=e[1],c=e[2],p=0,d=[];p<s.length;p++)l=s[p],Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&d.push(i[l][0]),i[l]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],n=!0,s=1;s<a.length;s++){var r=a[s];0!==i[r]&&(n=!1)}n&&(o.splice(e--,1),t=l(l.s=a[0]))}return t}var n={},i={app:0},o=[];function l(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=t,l.c=n,l.d=function(t,e,a){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)l.d(a,n,function(e){return t[e]}.bind(null,n));return a},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],r=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=r;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";a("85ec")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=a("5c96"),o=a.n(i),l=(a("0fae"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"fade"}},[a("router-view")],1)}),s=[],r={name:"App"},c=r,u=(a("034f"),a("2877")),p=Object(u["a"])(c,l,s,!1,null,null,null),d=p.exports,f=a("8c4f"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",[a("el-aside",{staticClass:"sideBar"},[a("el-col",[a("h2",[t._v("Movie DB")]),a("el-menu",{attrs:{"default-active":"1","background-color":"#313a46","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:t.menuSelect}},[a("el-menu-item",{attrs:{index:"1"}},[a("i",{staticClass:"el-icon-menu"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("全部")])]),a("el-menu-item",{attrs:{index:"2"}},[a("i",{staticClass:"el-icon-document"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("电影")])]),a("el-menu-item",{attrs:{index:"3"}},[a("i",{staticClass:"el-icon-document"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("剧集")])])],1)],1),a("el-col",[t._l(t.filterTags,(function(e){return a("el-tag",{key:e,staticClass:"filterTag",attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return t.closeTag(e)}}},[t._v(" "+t._s(e)+" ")])})),t.tagInputVisible?a("el-input",{ref:"saveTagInput",staticClass:"inputNewTag",attrs:{size:"small"},on:{blur:t.handleTagInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleTagInputConfirm(e)}},model:{value:t.tagInputValue,callback:function(e){t.tagInputValue=e},expression:"tagInputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showTagInput}},[t._v("+ 输入标签")])],2)],1),a("el-container",[a("el-header",[a("el-col",{staticClass:"optionModule",attrs:{span:2,xs:3}},[a("el-popover",{ref:"popover",attrs:{placement:"right",width:"200",trigger:"click"}},[a("div",[a("div",{staticClass:"hotTag",attrs:{id:"topTags"}},[a("p",[t._v("热门标签：")]),t._l(t.hotTags,(function(e){return a("el-tag",{key:e,staticClass:"movieTag",on:{click:function(a){return t.addTag(e)}}},[t._v(t._s(e)+" ")])}))],2),t._l(t.filterTags,(function(e){return a("el-tag",{key:e,staticClass:"filterTag inlineTag",attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return t.closeTag(e)}}},[t._v(" "+t._s(e)+" ")])})),t.tagInputVisible?a("el-input",{ref:"saveTagInput",staticClass:"inputNewTag",attrs:{size:"small"},on:{blur:t.handleTagInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleTagInputConfirm(e)}},model:{value:t.tagInputValue,callback:function(e){t.tagInputValue=e},expression:"tagInputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showTagInput}},[t._v("+ 输入标签")])],2),a("el-button",{staticClass:"optionButton",attrs:{slot:"reference",icon:"el-icon-menu",circle:""},slot:"reference"})],1)],1),a("el-col",{staticClass:"searchBar",attrs:{span:4,sm:5,xs:10}},[a("el-input",{attrs:{placeholder:"输入电影名称","suffix-icon":"el-icon-search",clearable:""},on:{input:t.search},model:{value:t.q,callback:function(e){t.q=e},expression:"q"}})],1),a("el-col",{staticClass:"orderMenu",attrs:{span:5,offset:12,xs:{span:10,offset:1}}},[a("div",[a("el-button",{class:{activeText:"-update_date"===t.order_by},attrs:{type:"text"},on:{click:function(e){return t.sort("-update_date")}}},[t._v("按上新")]),a("el-button",{class:{activeText:"-update_date"!=t.order_by},attrs:{type:"text"},on:{click:function(e){return t.sort("-douban_rating")}}},[t._v("按评分")])],1)])],1),a("el-main",[a("transition",{attrs:{name:"el-fade-in-linear"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.movieShow,expression:"movieShow"}],staticClass:"movieList",attrs:{gutter:20}},t._l(t.movies,(function(e){return a("el-col",{key:e.id,staticClass:"movieCard",attrs:{span:8,md:6,lg:4,xl:3}},[a("div",{staticClass:"movieItem"},[a("el-popover",{staticClass:"pcPoster",attrs:{"open-delay":400,placement:"right",width:"400",trigger:"hover"}},[a("div",{staticClass:"infomer"},[a("div",{staticClass:"intro"},[t._v(" "+t._s(e.intro)+" ")]),a("div",t._l(e.tags,(function(e){return a("el-tag",{key:e,staticClass:"movieTag",on:{click:function(a){return t.addTag(e)}}},[t._v(t._s(e))])})),1),a("a",{staticClass:"uri",attrs:{target:"_blank",href:e.douban_url}},[a("el-button",{attrs:{size:"mini",type:"success",plain:""}},[t._v("豆瓣")])],1)]),a("div",{staticClass:"poster",style:"background-image: url("+e.thumbnail_url+")",attrs:{slot:"reference"},on:{click:function(a){return t.goToMovie(e.id)}},slot:"reference"})]),a("div",{staticClass:"poster mobilePoster",style:"background-image: url("+e.thumbnail_url+")",attrs:{slot:"reference"},on:{click:function(a){return t.goToMovie(e.id)}},slot:"reference"})],1),a("div",{staticClass:"movieInfo"},[a("p",{staticClass:"movieTitle",attrs:{title:e.title}},[t._v(" "+t._s(e.title+(""!==e.original_title?" / ":"")+e.original_title)+" "),a("span",{staticClass:"movieYear"},[t._v(" ( "+t._s(e.year)+")")])]),a("div",{staticClass:"doubanRating"},[a("label",{staticClass:"豆瓣评分："}),a("el-rate",{attrs:{value:e.douban_rating/2,disabled:"","text-color":"#ff9900","disabled-void-color":""}}),a("i",{staticClass:"ratingText"},[t._v(" "+t._s(e.douban_rating)+" ")])],1)])])})),1)],1)],1)],1)],1)},g=[],v=(a("99af"),a("4160"),a("c975"),a("a15b"),a("a434"),a("ac1f"),a("1276"),a("159b"),a("bc3a")),y={name:"home",data:function(){return{api:"./api",token:"",movies:[],type:"",page:1,limit:24,q:"",order_by:"-update_date",movieShow:!1,noMore:!1,filterTags:[],tagInputVisible:!1,tagInputValue:"",hotTags:[]}},methods:{getToken:function(){var t=this;t.$prompt("请输入账号密码（账号:密码）","认证",{confirmButtonText:"确定",inputPattern:/.*:.*?/,inputErrorMessage:"格式不正确"}).then((function(e){var a=e.value,n=a.split(":");v.post("/api/auth",{username:n[0],password:n[1]}).then((function(e){localStorage.token=e.data.access_token,t.token=localStorage.token,v.defaults.headers.common["Authorization"]="JWT ".concat(t.token),t.getHotTags(),t.getMovies()})).catch((function(e){t.$message({type:"info",message:"账号密码错误，刷新重试"}),console.log(e)}))})).catch((function(){}))},reset:function(){this.movieShow=!1,this.movies=[],this.type="",this.page=1,this.limit=40,this.q="",this.order_by="-update_date"},refreshByTag:function(){this.page=0,this.movies=[],this.getMovies()},getMovies:function(){var t=this;v.get("/api/movies?page=".concat(t.page,"&limit=").concat(t.limit,"&q=").concat(t.q,"&year=&type=").concat(t.type,"&order_by=").concat(t.order_by,"&tags=").concat(t.filterTags.join(","))).then((function(e){0==e.data.length&&(t.noMore=!0),e.data.forEach((function(e){t.movies.push(e),t.movieShow=!0}))})).catch((function(e){console.log(e),t.getToken()}))},menuSelect:function(t){this.reset(),this.type="3"===t?"剧集":"2"===t?"电影":"",this.getMovies()},infLoad:function(){this.noMore||(this.page++,this.getMovies())},sort:function(t){this.reset(),this.order_by=t,this.getMovies()},search:function(){this.page=1,this.movies=[],this.getMovies()},goToMovie:function(t){this.$router.push({path:"/movie/".concat(t)})},addTag:function(t){-1===this.filterTags.indexOf(t)&&(this.filterTags.push(t),this.refreshByTag())},closeTag:function(t){var e=this.filterTags.indexOf(t);this.filterTags.splice(e,1),this.refreshByTag()},showTagInput:function(){var t=this;this.tagInputVisible=!0,this.$nextTick((function(e){console.log(e),t.$refs.saveTagInput.$refs.input.focus()}))},getHotTags:function(){var t=this;v.get("/api/tags/top").then((function(e){e.data.forEach((function(e){t.hotTags.push(e[0])}))})).catch((function(e){console.log(e),t.getToken()}))},handleTagInputConfirm:function(){var t=this.tagInputValue;""!==t&&-1===this.filterTags.indexOf(t)&&(this.filterTags.push(t),this.refreshByTag()),this.tagInputVisible=!1,this.tagInputValue=""}},mounted:function(){console.log("BASE_URL: ","/"),console.log("VUE_APP_API: ","./api"),localStorage.token?(this.token=localStorage.token,v.defaults.headers.common["Authorization"]="JWT ".concat(this.token),this.getHotTags(),this.getMovies()):this.getToken();var t=this;window.onscroll=function(){var e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,n=window.innerHeight||Math.min(document.documentElement.clientHeight,document.body.clientHeight);n+a>=e&&t.infLoad()}}},m=y,b=(a("ac05"),Object(u["a"])(m,h,g,!1,null,"bb200a3e",null)),_=b.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",[a("el-header",[a("el-col",{attrs:{span:12,lg:11}},[a("div",{staticClass:"backButton"},[a("el-button",{attrs:{icon:"el-icon-back",circle:""},on:{click:function(e){return t.goBack()}}})],1)]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"playOption"},[a("el-select",{attrs:{placeholder:"选择App"},on:{change:t.changePlayType},model:{value:t.playType,callback:function(e){t.playType=e},expression:"playType"}},t._l(t.playOptions,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.label}})})),1)],1)])],1),a("el-main",[a("el-dialog",{attrs:{title:"提示",visible:t.tipVisible},on:{"update:visible":function(e){t.tipVisible=e}}},[a("p",[t._v("Windows下在页面打开PotPlayer播放需注册协议，本提示不会再次弹出。")]),a("p",[t._v("输入PotPlayer路径：")]),a("el-input",{attrs:{autocomplete:"off"},model:{value:t.potplayer,callback:function(e){t.potplayer=e},expression:"potplayer"}}),a("p",[t._v("复制以下内容另存为potplayer.reg，双击合并到注册表。")]),a("el-input",{attrs:{type:"textarea",rows:5,placeholder:""},model:{value:t.pcRegCode,callback:function(e){t.pcRegCode=e},expression:"pcRegCode"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.tipVisible=!1}}},[t._v("确 定")])],1)],1),a("transition",{attrs:{name:"el-fade-in-linear"}},[a("div",[a("el-col",{attrs:{span:24,lg:18}},[a("div",{staticClass:"movieInfo"},[a("div",{staticClass:"movieTitle"},[t._v(t._s(t.fullTitle))]),a("div",{staticClass:"doubanDesc",domProps:{innerHTML:t._s(t.descHtml)}}),a("div",{staticClass:"doubanIntro"},[a("span",[t._v(" 内容简介 · · · · · · ")]),a("p",[t._v(" "+t._s(t.intro)+" ")])])])]),a("el-col",{attrs:{span:24,lg:6}},[a("div",{staticClass:"moviePlay"},[a("div",{staticClass:"playTitle"},[t._v("播放列表")]),a("div",{staticClass:"playLinks"},t._l(t.playList,(function(e,n){return a("a",{key:e.link,attrs:{href:e.link}},[a("span",[a("el-button",{staticClass:"videoButton",attrs:{type:"info"}},[t._v(" "+t._s(n+1))])],1)])})),0)])]),a("el-col",{attrs:{span:24}})],1)])],1)],1)},k=[],C=(a("466d"),a("b85c")),w=a("bc3a"),P={name:"movie",data:function(){return{id:"",playOptions:[{label:"nPlayer"},{label:"VLC"},{label:"MXPlayer"},{label:"MXPlayer Pro"},{label:"PotPlayer"}],playType:"nPlayer",videoFiles:[],title:"",year:"",originalTitle:"",uri:"",intro:"",doubanUrl:"",thumbnailUrl:"",descHtml:"",potplayer:"C:\\\\Program Files\\\\DAUM\\\\PotPlayer\\\\PotPlayerMini64.exe",tipVisible:!1}},computed:{playList:function(){var t=[];if("nPlayer"===this.playType){var e,a=Object(C["a"])(this.videoFiles);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.push({link:"nplayer-".concat(n)})}}catch(v){a.e(v)}finally{a.f()}}if("MXPlayer"===this.playType){var i,o=Object(C["a"])(this.videoFiles);try{for(o.s();!(i=o.n()).done;){var l=i.value;t.push({link:"intent:".concat(l,"#Intent;package=com.mxtech.videoplayer.ad;S.title=New%20title;end")})}}catch(v){o.e(v)}finally{o.f()}}if("MXPlayer Pro"===this.playType){var s,r=Object(C["a"])(this.videoFiles);try{for(r.s();!(s=r.n()).done;){var c=s.value;t.push({link:"intent:".concat(c,"#Intent;package=com.mxtech.videoplayer.pro;S.title=New%20title;end")})}}catch(v){r.e(v)}finally{r.f()}}if("VLC"===this.playType){var u,p=Object(C["a"])(this.videoFiles);try{for(p.s();!(u=p.n()).done;){var d=u.value;t.push({link:"vlc://".concat(d)})}}catch(v){p.e(v)}finally{p.f()}}if("PotPlayer"===this.playType){var f,h=Object(C["a"])(this.videoFiles);try{for(h.s();!(f=h.n()).done;){var g=f.value;t.push({link:"potplayer://".concat(g)})}}catch(v){h.e(v)}finally{h.f()}}return t},pcRegCode:function(){return'Windows Registry Editor Version 5.00\n\n[HKEY_CLASSES_ROOT\\potplayer]\n@="\\"URL:potplayer protocol\\""\n"URL Protocol"=""\n\n[HKEY_CLASSES_ROOT\\potplayer\\shell]\n\n[HKEY_CLASSES_ROOT\\potplayer\\shell\\open]\n\n[HKEY_CLASSES_ROOT\\potplayer\\shell\\open\\command]\n@="cmd /k ( set \\"var=%1\\" & call set var=%%var:potplayer://=%% & call \\"'.concat(this.potplayer,'\\" %%var%%)"\n')},fullTitle:function(){return""!==this.originalTitle?"".concat(this.title," / ").concat(this.originalTitle,"（").concat(this.year,"）"):this.title}},methods:{isMobile:function(){var t=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);return t},changePlayType:function(t){localStorage.play_type=t},getData:function(){var t=this;w.get("/api/movie/".concat(t.id)).then((function(e){var a=e.data;t.videoFiles=a.play_links,t.title=a.title,t.year=a.year,t.originalTitle=a.original_title,t.intro=a.intro,t.uri=a.uri,t.doubanUrl=a.douban_url,t.thumbnailUrl=a.thumbnail_url,t.descHtml=a.desc_html})).catch((function(e){console.log(e),t.goBack()}))},goBack:function(){this.$router.push({path:"/home"})}},mounted:function(){this.id=this.$route.params.id,localStorage.play_type&&(this.playType=localStorage.play_type),localStorage.token?(this.token=localStorage.token,w.defaults.headers.common["Authorization"]="JWT ".concat(this.token)):this.goBack(),this.getData(),this.isMobile()?this.playType="VLC":(this.playType="PotPlayer",localStorage.pc_tip||(this.tipVisible=!0,localStorage.pc_tip=1))}},x=P,S=(a("66ef"),Object(u["a"])(x,T,k,!1,null,"5dea5092",null)),O=S.exports;n["default"].use(f["a"]);var M=[{path:"",redirect:"/home"},{path:"/home",component:_},{path:"/movie/:id",component:O}],I=new f["a"]({routes:M,mode:"history",linkActiveClass:"active"}),V=I;n["default"].config.productionTip=!1,n["default"].use(o.a),new n["default"]({router:V,render:function(t){return t(d)}}).$mount("#app")},"66ef":function(t,e,a){"use strict";a("7118")},7118:function(t,e,a){},"7c05":function(t,e,a){},"85ec":function(t,e,a){},ac05:function(t,e,a){"use strict";a("7c05")}});
//# sourceMappingURL=app.d8f088db.js.map